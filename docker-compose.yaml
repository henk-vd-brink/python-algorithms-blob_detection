version: "3"

services:
  detector:
    container_name: detector
    build:
      context: detector
      dockerfile: dockerfile
    ports:
      - 5000:5000
    devices:
      - "/dev/video0"
    environment:
      - NUMBER_OF_DETECTION_THREADS=1
      - DISABLE_JIT=1
      # - GST_DEBUG=4
    volumes:
      - ./media:/media
      - /dev/bus/usb:/dev/bus/usb
    runtime: nvidia

  # streamer:
  #   container_name: streamer
  #   build:
  #     context: streamer
  #     dockerfile: dockerfile
  #   devices:
  #     - "/dev/video0"
  #   volumes:
  #     - ./media:/media
  #     - /dev/bus/usb:/dev/bus/usb
  #   runtime: nvidia

